<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What to Share ‚Äî FrameShift P16</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
<script>
  window.FrameShift={STORAGE_KEY:"frameshift_progress",load:function(){try{var r=localStorage.getItem(this.STORAGE_KEY);return r?JSON.parse(r):{sessions:{},achievements:[]}}catch(e){return{sessions:{},achievements:[]}}},save:function(d){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(d))}catch(e){}},saveSession:function(id,ts,tm,xs,xm,m){var d=this.load();if(!d.sessions[id])d.sessions[id]=[];d.sessions[id].push({date:new Date().toISOString(),train:{score:ts,max:tm},test:xs!==null?{score:xs,max:xm}:null,mastery:m});this.save(d)}};
</script>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:'Nunito',sans-serif;min-height:100vh;background:linear-gradient(145deg,#FCE4EC 0%,#F8BBD0 25%,#F48FB1 50%,#EC407A 100%);overflow-x:hidden}
  h1,h2,h3,.fredoka{font-family:'Fredoka',sans-serif}
  .frameshift-back{position:fixed;top:16px;left:16px;z-index:1000;background:rgba(255,255,255,0.85);backdrop-filter:blur(8px);padding:8px 16px;border-radius:20px;font-family:'Fredoka',sans-serif;font-weight:600;font-size:14px;color:#AD1457;text-decoration:none;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:transform 0.2s}
  .frameshift-back:hover{transform:translateY(-1px)}
  @keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
  @keyframes popIn{0%{opacity:0;transform:scale(0.7)}70%{transform:scale(1.05)}100%{opacity:1;transform:scale(1)}}
  @keyframes glowPulse{0%,100%{box-shadow:0 0 20px rgba(236,64,122,0.3)}50%{box-shadow:0 0 40px rgba(236,64,122,0.6)}}
  .animate-slide-up{animation:slideUp 0.5s ease-out forwards}
  .animate-pop{animation:popIn 0.4s ease-out forwards}
  .animate-glow{animation:glowPulse 2s ease-in-out infinite}
</style>
</head>
<body>
<a href="index.html" class="frameshift-back">‚Üê FrameShift</a>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useRef}=React;

function playSound(t){try{const c=new(window.AudioContext||window.webkitAudioContext)();const n=c.currentTime;if(t==='correct'){[440,554,659].forEach((f,i)=>{const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=f;o.type='sine';g.gain.setValueAtTime(0.15,n+i*0.12);g.gain.exponentialRampToValueAtTime(0.001,n+i*0.12+0.3);o.start(n+i*0.12);o.stop(n+i*0.12+0.3)})}else if(t==='incorrect'){const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=330;o.type='sine';g.gain.setValueAtTime(0.12,n);o.frequency.linearRampToValueAtTime(220,n+0.3);g.gain.exponentialRampToValueAtTime(0.001,n+0.3);o.start(n);o.stop(n+0.35)}else if(t==='neutral'){const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=440;o.type='sine';g.gain.setValueAtTime(0.08,n);g.gain.exponentialRampToValueAtTime(0.001,n+0.25);o.start(n);o.stop(n+0.3)}else if(t==='complete'){[523,587,659,784,880].forEach((f,i)=>{const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=f;o.type='sine';g.gain.setValueAtTime(0.15,n+i*0.15);g.gain.exponentialRampToValueAtTime(0.001,n+i*0.15+0.4);o.start(n+i*0.15);o.stop(n+i*0.15+0.45)})}}catch(e){}}

function shuffle(a){const b=[...a];for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[b[i],b[j]]=[b[j],b[i]]}return b}

// person emoji, who asks, what they ask, correct answer, wrong answers, explanation, safety level
const TRAIN_SCENARIOS = [
  { who: "üë©", person: "Mom", asks: "What happened at school today?", correct: "I had a math test and played at recess", wrongs: ["Nothing, leave me alone", "I don't remember anything"], explain: "Mom is a safe, trusted person ‚Äî you can share details about your day!", safety: "safe" },
  { who: "üßî", person: "A stranger at the park", asks: "Where do you live?", correct: "I'm not supposed to tell people that", wrongs: ["123 Oak Street", "Right down that road over there"], explain: "Strangers should NOT know where you live. It's okay to say no!", safety: "unsafe" },
  { who: "üöå", person: "The bus driver", asks: "How's your day going?", correct: "Pretty good, thanks!", wrongs: ["My parents aren't home until 6", "My sister is sick and nobody is watching her"], explain: "Bus drivers are friendly but you keep it general ‚Äî no personal family details.", safety: "acquaintance" },
  { who: "üë®‚Äç‚öïÔ∏è", person: "Your doctor", asks: "Does anything hurt?", correct: "My stomach has been hurting after lunch", wrongs: ["No, everything is fine (even though something hurts)", "I don't want to talk about it"], explain: "Doctors need to know what hurts so they can help you. Be honest!", safety: "safe" },
  { who: "üë¶", person: "A new kid at school", asks: "What's your phone number?", correct: "Let me ask my parents first", wrongs: ["It's 555-1234!", "Here, I'll also give you my address"], explain: "Even kids at school ‚Äî check with your parents before sharing phone numbers.", safety: "acquaintance" },
  { who: "üë©‚Äçüè´", person: "Your teacher", asks: "Why were you late today?", correct: "My mom's car had trouble starting", wrongs: ["My parents were fighting this morning", "None of your business"], explain: "Teachers need a reason, but keep it simple ‚Äî no need to share everything.", safety: "safe" },
  { who: "üßë", person: "Someone online in a game", asks: "What school do you go to?", correct: "I don't share that online", wrongs: ["Lincoln Elementary on 5th Street", "The one near the big park"], explain: "NEVER share your school or location with people online!", safety: "unsafe" },
  { who: "üëµ", person: "Grandma on the phone", asks: "What do you want for your birthday?", correct: "I really want the new LEGO set!", wrongs: ["I don't know", "Whatever"], explain: "Grandma is safe and wants to know! Share what makes you happy.", safety: "safe" },
];

const TEST_MC_SCENARIOS = [
  { who: "üßë‚Äçüîß", person: "A repair person at your house", asks: "Are your parents home?", correct: "My dad is in the other room", wrongs: ["No, I'm home alone", "They won't be back for hours"], explain: "Don't tell service people you're alone. Say a parent is nearby.", safety: "acquaintance" },
  { who: "üëß", person: "Your best friend", asks: "What are you doing this weekend?", correct: "We're going to the beach on Saturday!", wrongs: ["I can't tell you", "I don't know (when you do know)"], explain: "Best friends are safe to share plans with!", safety: "safe" },
  { who: "üì±", person: "A text from an unknown number", asks: "Is this [your name]? Send a pic?", correct: "Don't reply ‚Äî tell a parent", wrongs: ["Yes that's me! Here's a selfie", "Who is this? Yes I'm [name]"], explain: "Unknown numbers asking for photos? Don't respond. Tell a grown-up.", safety: "unsafe" },
  { who: "üõí", person: "The cashier at a store", asks: "How old are you?", correct: "I'm ten!", wrongs: ["I live at 456 Elm St", "My parents make $50,000 a year"], explain: "Your age is fine to share, but don't volunteer extra personal info.", safety: "acquaintance" },
];

const TEST_GEN_SCENARIOS = [
  { who: "üëÆ", person: "A police officer helping you", asks: "Can you tell me your parents' names?", goodAnswer: "Share parents' names ‚Äî police are safe trusted adults when helping", safety: "safe" },
  { who: "üßë", person: "An adult you don't know at the mall", asks: "Can you come help me find my puppy?", goodAnswer: "Say no and find a trusted adult ‚Äî strangers shouldn't ask kids for help", safety: "unsafe" },
  { who: "üë©‚Äçüç≥", person: "The lunch lady at school", asks: "Do you have any allergies?", goodAnswer: "Tell her your allergies ‚Äî she needs to know to keep you safe", safety: "safe" },
  { who: "üßí", person: "A kid on the playground you just met", asks: "What's your password for [game]?", goodAnswer: "Never share passwords with anyone except parents", safety: "unsafe" },
];

const TRAIN_TOTAL = TRAIN_SCENARIOS.length;
const TEST_MC_TOTAL = TEST_MC_SCENARIOS.length;
const TEST_GEN_TOTAL = TEST_GEN_SCENARIOS.length;
const MASTERY = 0.75;

function App() {
  const [screen, setScreen] = useState('welcome');
  const [phase, setPhase] = useState(null);
  const [idx, setIdx] = useState(0);
  const [trainScore, setTrainScore] = useState(0);
  const [testMcScore, setTestMcScore] = useState(0);
  const [genScores, setGenScores] = useState([]);
  const [options, setOptions] = useState([]);
  const [selected, setSelected] = useState(null);
  const [showFb, setShowFb] = useState(false);
  const [answered, setAnswered] = useState(false);
  const [childResp, setChildResp] = useState('');
  const [genScored, setGenScored] = useState(false);

  const getItems = () => {
    if (phase === 'train') return TRAIN_SCENARIOS;
    if (phase === 'test_mc') return TEST_MC_SCENARIOS;
    return TEST_GEN_SCENARIOS;
  };

  useEffect(() => {
    const items = getItems();
    if (!items[idx]) return;
    const it = items[idx];
    if (phase !== 'test_gen' && it.correct && it.wrongs) {
      setOptions(shuffle([
        { text: it.correct, isCorrect: true },
        ...it.wrongs.map(w => ({ text: w, isCorrect: false }))
      ]));
    }
    setSelected(null); setShowFb(false); setAnswered(false);
  }, [idx, phase]);

  function start(p) {
    setPhase(p); setIdx(0);
    setSelected(null); setShowFb(false); setAnswered(false);
    setChildResp(''); setGenScored(false);
    if (p === 'train') setTrainScore(0);
    else if (p === 'test_mc') setTestMcScore(0);
    else setGenScores([]);
    setScreen('game');
  }

  function handleAnswer(i) {
    if (answered) return;
    setSelected(i); setAnswered(true);
    const correct = options[i].isCorrect;
    if (correct) {
      if (phase === 'train') setTrainScore(s => s + 1);
      else setTestMcScore(s => s + 1);
    }
    playSound(phase === 'train' ? (correct ? 'correct' : 'incorrect') : 'neutral');
    setShowFb(true);
  }

  function handleGenScore(score) {
    const items = getItems();
    setGenScores(prev => [...prev, { scenario: items[idx], score, response: childResp }]);
    setGenScored(true); playSound('neutral');
  }

  function next() {
    const items = getItems();
    if (idx < items.length - 1) {
      setIdx(idx + 1);
      setChildResp(''); setGenScored(false);
    } else {
      if (phase === 'train') setScreen('trainRes');
      else if (phase === 'test_mc') setScreen('testMcRes');
      else {
        const gc = genScores.filter(g => g.score === 'correct').length;
        if (window.FrameShift) window.FrameShift.saveSession("p16", trainScore, TRAIN_TOTAL, testMcScore + gc, TEST_MC_TOTAL + TEST_GEN_TOTAL, true);
        playSound('complete'); setScreen('finalRes');
      }
    }
  }

  const items = getItems();
  const item = items[idx];
  const progress = ((idx + (answered || genScored ? 0.5 : 0)) / items.length) * 100;

  // Safety badge
  function SafetyBadge({safety}) {
    const colors = { safe: {bg:'#E8F5E9',c:'#2E7D32',t:'Safe Person'}, unsafe: {bg:'#FFEBEE',c:'#C62828',t:'Be Careful!'}, acquaintance: {bg:'#FFF8E1',c:'#F57F17',t:'Keep It General'} };
    const s = colors[safety] || colors.acquaintance;
    return <span className="fredoka text-xs font-bold px-3 py-1 rounded-full" style={{background:s.bg,color:s.c}}>{s.t}</span>;
  }

  if (screen === 'welcome') return (
    <div className="min-h-screen flex items-center justify-center p-4"><div className="animate-slide-up max-w-lg w-full text-center">
      <div className="text-8xl mb-6">üîí</div>
      <h1 className="fredoka text-5xl font-bold mb-3" style={{color:'#880E4F'}}>What to Share</h1>
      <p className="text-xl mb-2 font-semibold" style={{color:'#AD1457'}}>FrameShift Program 16</p>
      <div className="bg-white bg-opacity-70 rounded-2xl p-6 mb-8 shadow-lg" style={{backdropFilter:'blur(8px)'}}>
        <p className="text-lg" style={{color:'#880E4F'}}>Different people can know different things about you.</p>
        <p className="text-base mt-3" style={{color:'#AD1457'}}>What's safe to say ‚Äî and when should you hold back?</p>
      </div>
      <button onClick={()=>start('train')} className="px-10 py-4 rounded-full text-xl font-bold text-white shadow-lg hover:scale-105 active:scale-95 transition-all" style={{background:'linear-gradient(135deg,#AD1457,#D81B60)',fontFamily:'Fredoka'}}>Start Training üîí</button>
    </div></div>
  );

  if (screen === 'game' && (phase === 'train' || phase === 'test_mc')) {
    const it = item;
    const isTest = phase === 'test_mc';
    const correctIdx = options.findIndex(o => o.isCorrect);

    return (
      <div className="min-h-screen flex flex-col items-center p-4 pt-16">
        <div className="w-full max-w-lg mb-4">
          <div className="flex justify-between items-center mb-2">
            <span className="fredoka font-bold text-sm px-3 py-1 rounded-full" style={{background:isTest?'#880E4F':'#D81B60',color:'white'}}>{isTest?'Test':'Training'}</span>
            <span className="fredoka text-sm font-semibold" style={{color:'#880E4F'}}>Scene {idx+1} of {items.length}</span>
          </div>
          <div className="w-full h-3 rounded-full overflow-hidden" style={{background:'rgba(255,255,255,0.5)'}}>
            <div className="h-full rounded-full transition-all duration-500" style={{width:`${progress}%`,background:'linear-gradient(90deg,#AD1457,#EC407A)'}}/>
          </div>
        </div>
        <div className="w-full max-w-lg animate-slide-up">
          <div className="bg-white bg-opacity-80 rounded-3xl p-6 shadow-xl" style={{backdropFilter:'blur(8px)'}}>
            {/* Scenario */}
            <div className="text-center mb-4">
              <span className="text-6xl">{it.who}</span>
              <p className="fredoka text-lg font-bold mt-2" style={{color:'#880E4F'}}>{it.person}</p>
            </div>
            <div className="rounded-xl p-4 mb-5" style={{background:'linear-gradient(135deg,#FCE4EC,#F8BBD0)'}}>
              <p className="text-lg text-center" style={{color:'#880E4F'}}>
                <strong>{it.person}</strong> asks: "{it.asks}"
              </p>
            </div>
            <p className="fredoka text-lg font-bold text-center mb-4" style={{color:'#AD1457'}}>What should you say?</p>

            <div className="space-y-3 mb-4">
              {options.map((o, i) => {
                let bg='white',border='#F8BBD0',tc='#880E4F';
                if(showFb&&!isTest){if(i===correctIdx){bg='#E8F5E9';border='#4CAF50';tc='#2E7D32'}else if(i===selected&&!o.isCorrect){bg='#FFEBEE';border='#EF5350';tc='#C62828'}}
                else if(showFb&&isTest&&i===selected){bg='#FCE4EC';border='#EC407A';tc='#880E4F'}
                return <button key={i} onClick={()=>handleAnswer(i)} disabled={answered}
                  className="w-full p-4 rounded-xl font-semibold transition-all text-left"
                  style={{background:bg,border:`2px solid ${border}`,color:tc,opacity:answered&&i!==selected&&!(showFb&&!isTest&&i===correctIdx)?0.5:1,cursor:answered?'default':'pointer'}}>
                  "{o.text}"
                </button>
              })}
            </div>

            {showFb && (
              <div className="animate-pop">
                {isTest ? (
                  <div className="text-center rounded-xl p-3 mb-4" style={{background:'#FCE4EC'}}>
                    <p className="fredoka font-semibold" style={{color:'#AD1457'}}>Response recorded ‚úì</p>
                  </div>
                ) : (
                  <div className="rounded-xl p-4 mb-4" style={{background: options[selected]?.isCorrect?'#E8F5E9':'#FFF3E0'}}>
                    {options[selected]?.isCorrect ?
                      <p className="fredoka font-semibold text-center" style={{color:'#2E7D32'}}>‚úÖ Smart choice!</p> :
                      <p className="fredoka font-semibold text-center" style={{color:'#E65100'}}>Better answer: "{it.correct}"</p>}
                    <p className="text-sm mt-2 text-center" style={{color:'#5D4037'}}>{it.explain}</p>
                    <div className="text-center mt-2"><SafetyBadge safety={it.safety}/></div>
                  </div>
                )}
                <div className="text-center"><button onClick={next} className="px-8 py-3 rounded-full text-lg font-bold text-white shadow-lg hover:scale-105 active:scale-95 transition-all" style={{background:'linear-gradient(135deg,#AD1457,#D81B60)',fontFamily:'Fredoka'}}>Next ‚Üí</button></div>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  }

  if (screen === 'game' && phase === 'test_gen') {
    const it = item;
    return (
      <div className="min-h-screen flex flex-col items-center p-4 pt-16">
        <div className="w-full max-w-lg mb-4">
          <div className="flex justify-between items-center mb-2">
            <span className="fredoka font-bold text-sm px-3 py-1 rounded-full" style={{background:'#880E4F',color:'white'}}>Test ‚Äî Create</span>
            <span className="fredoka text-sm font-semibold" style={{color:'#880E4F'}}>Scene {idx+1} of {items.length}</span>
          </div>
          <div className="w-full h-3 rounded-full overflow-hidden" style={{background:'rgba(255,255,255,0.5)'}}>
            <div className="h-full rounded-full transition-all duration-500" style={{width:`${progress}%`,background:'linear-gradient(90deg,#AD1457,#EC407A)'}}/>
          </div>
        </div>
        <div className="w-full max-w-lg animate-slide-up">
          <div className="bg-white bg-opacity-80 rounded-3xl p-6 shadow-xl" style={{backdropFilter:'blur(8px)'}}>
            <p className="fredoka text-sm font-bold uppercase tracking-wider mb-2 text-center" style={{color:'#880E4F'}}>‚≠ê Your Turn to Respond!</p>
            <div className="text-center mb-3"><span className="text-6xl">{it.who}</span></div>
            <div className="rounded-xl p-4 mb-4" style={{background:'linear-gradient(135deg,#FCE4EC,#F8BBD0)'}}>
              <p className="text-lg text-center" style={{color:'#880E4F'}}><strong>{it.person}</strong> asks: "{it.asks}"</p>
            </div>
            <p className="fredoka text-lg font-bold text-center mb-3" style={{color:'#AD1457'}}>What would you say?</p>

            <div className="rounded-2xl p-4 mb-4" style={{background:'#FFF8E1',border:'2px dashed #FFB74D'}}>
              <p className="fredoka text-sm font-bold mb-3" style={{color:'#E65100'}}>üßë‚Äçüè´ Caregiver: Write what the child says</p>
              <input type="text" value={childResp} onChange={e=>setChildResp(e.target.value)} disabled={genScored}
                placeholder="Type the child's response..." className="w-full p-3 rounded-xl text-base border-2 focus:outline-none"
                style={{borderColor:genScored?'#C8E6C9':'#FFB74D',background:genScored?'#F1F8E9':'white',color:'#880E4F'}}/>

              {!genScored && childResp.trim().length > 0 && (
                <div className="mt-4 animate-pop">
                  <p className="text-sm font-semibold mb-1" style={{color:'#BF360C'}}>Is this an appropriate response?</p>
                  <p className="text-xs mb-3" style={{color:'#8D6E63'}}>Good answer: {it.goodAnswer}</p>
                  <div className="flex gap-2">
                    <button onClick={()=>handleGenScore('correct')} className="flex-1 py-3 rounded-xl font-bold text-white hover:scale-105 transition-all" style={{background:'#4CAF50',fontFamily:'Fredoka'}}>‚úÖ Yes</button>
                    <button onClick={()=>handleGenScore('partial')} className="flex-1 py-3 rounded-xl font-bold text-white hover:scale-105 transition-all" style={{background:'#FF9800',fontFamily:'Fredoka'}}>üü° Partial</button>
                    <button onClick={()=>handleGenScore('incorrect')} className="flex-1 py-3 rounded-xl font-bold text-white hover:scale-105 transition-all" style={{background:'#EF5350',fontFamily:'Fredoka'}}>‚ùå No</button>
                  </div>
                </div>
              )}
              {!genScored && childResp.trim().length === 0 && (
                <button onClick={()=>{setChildResp('(no response)');handleGenScore('incorrect')}} className="mt-3 px-4 py-2 rounded-lg text-sm font-semibold" style={{background:'#FFEBEE',color:'#C62828',fontFamily:'Fredoka'}}>No Response</button>
              )}
            </div>

            {genScored && (
              <div className="animate-pop text-center">
                <div className="rounded-xl p-3 mb-4" style={{background:'#FCE4EC'}}>
                  <p className="fredoka font-semibold" style={{color:'#AD1457'}}>Response recorded ‚úì</p>
                  <p className="text-sm mt-1" style={{color:'#880E4F'}}>{it.goodAnswer}</p>
                </div>
                <button onClick={next} className="px-8 py-3 rounded-full text-lg font-bold text-white shadow-lg hover:scale-105 active:scale-95 transition-all" style={{background:'linear-gradient(135deg,#AD1457,#D81B60)',fontFamily:'Fredoka'}}>Next ‚Üí</button>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  }

  if (screen === 'trainRes') {
    const pct = Math.round((trainScore/TRAIN_TOTAL)*100); const passed = pct >= MASTERY*100;
    return <div className="min-h-screen flex items-center justify-center p-4"><div className="animate-slide-up max-w-lg w-full text-center">
      <div className="bg-white bg-opacity-80 rounded-3xl p-8 shadow-xl" style={{backdropFilter:'blur(8px)'}}>
        <div className="text-6xl mb-4">{passed?'üéâ':'üîÑ'}</div>
        <h2 className="fredoka text-3xl font-bold mb-2" style={{color:'#880E4F'}}>{passed?'Training Complete!':'Keep Practicing!'}</h2>
        <div className="my-6 rounded-xl p-4" style={{background:'#FCE4EC'}}><p className="fredoka text-lg font-semibold" style={{color:'#AD1457'}}>Score: {trainScore}/{TRAIN_TOTAL} ({pct}%)</p></div>
        {passed?<button onClick={()=>start('test_mc')} className="px-10 py-4 rounded-full text-xl font-bold text-white shadow-lg hover:scale-105 transition-all" style={{background:'linear-gradient(135deg,#880E4F,#AD1457)',fontFamily:'Fredoka'}}>Start Test üß™</button>
        :<button onClick={()=>start('train')} className="px-10 py-4 rounded-full text-xl font-bold text-white shadow-lg hover:scale-105 transition-all" style={{background:'linear-gradient(135deg,#AD1457,#D81B60)',fontFamily:'Fredoka'}}>Try Again üîí</button>}
        <div className="mt-4"><a href="index.html" className="text-sm font-semibold" style={{color:'#AD1457'}}>‚Üê Back to FrameShift</a></div>
      </div>
    </div></div>;
  }

  if (screen === 'testMcRes') {
    const pct = Math.round((testMcScore/TEST_MC_TOTAL)*100);
    return <div className="min-h-screen flex items-center justify-center p-4"><div className="animate-slide-up max-w-lg w-full text-center">
      <div className="bg-white bg-opacity-80 rounded-3xl p-8 shadow-xl" style={{backdropFilter:'blur(8px)'}}>
        <div className="text-5xl mb-4">üåø</div>
        <h2 className="fredoka text-2xl font-bold mb-2" style={{color:'#880E4F'}}>Multiple Choice Done!</h2>
        <div className="my-4 rounded-xl p-4" style={{background:'#FCE4EC'}}><p className="fredoka text-lg font-semibold" style={{color:'#AD1457'}}>Recognition: {testMcScore}/{TEST_MC_TOTAL} ({pct}%)</p></div>
        <div className="rounded-2xl p-5 mb-6" style={{background:'#FFF8E1',border:'2px solid #FFB74D'}}>
          <p className="fredoka text-lg font-bold mb-2" style={{color:'#E65100'}}>üßë‚Äçüè´ Next: Generation!</p>
          <p className="text-sm" style={{color:'#BF360C'}}>New situations ‚Äî the child says what they'd respond. No choices to pick from!</p>
        </div>
        <button onClick={()=>start('test_gen')} className="px-10 py-4 rounded-full text-xl font-bold text-white shadow-lg hover:scale-105 transition-all" style={{background:'linear-gradient(135deg,#880E4F,#AD1457)',fontFamily:'Fredoka'}}>Start Generation üåü</button>
        <div className="mt-4"><a href="index.html" className="text-sm font-semibold" style={{color:'#AD1457'}}>‚Üê Back to FrameShift</a></div>
      </div>
    </div></div>;
  }

  if (screen === 'finalRes') {
    const mcPct = Math.round((testMcScore/TEST_MC_TOTAL)*100);
    const gc = genScores.filter(g=>g.score==='correct').length;
    const gp = genScores.filter(g=>g.score==='partial').length;
    return <div className="min-h-screen flex items-center justify-center p-4"><div className="animate-slide-up max-w-lg w-full text-center">
      <div className="bg-white bg-opacity-80 rounded-3xl p-8 shadow-xl animate-glow" style={{backdropFilter:'blur(8px)'}}>
        <div className="text-6xl mb-4">üèÜ</div>
        <h2 className="fredoka text-3xl font-bold mb-2" style={{color:'#880E4F'}}>All Done!</h2>
        <div className="my-6 space-y-3">
          <div className="rounded-xl p-3" style={{background:'#FCE4EC'}}><p className="fredoka text-base font-semibold" style={{color:'#AD1457'}}>Recognition: {testMcScore}/{TEST_MC_TOTAL} ({mcPct}%)</p></div>
          <div className="rounded-xl p-4" style={{background:'linear-gradient(135deg,#FCE4EC,#F8BBD0)',border:'2px solid #EC407A'}}>
            <p className="fredoka text-xl font-bold" style={{color:'#880E4F'}}>‚≠ê Generation: {gc}/{TEST_GEN_TOTAL}</p>
            {gp>0&&<p className="text-sm mt-1" style={{color:'#AD1457'}}>+ {gp} partial</p>}
          </div>
        </div>
        {genScores.length>0&&<div className="text-left rounded-xl p-4 mb-4" style={{background:'#FCE4EC'}}>
          <p className="fredoka text-sm font-bold mb-2" style={{color:'#AD1457'}}>Responses:</p>
          {genScores.map((g,i)=>(<div key={i} className="flex items-start gap-2 mb-2">
            <span className="text-lg">{g.score==='correct'?'‚úÖ':g.score==='partial'?'üü°':'‚ùå'}</span>
            <p className="text-sm"><strong>{g.scenario.person}</strong>: "{g.response}"</p>
          </div>))}
        </div>}
        <button onClick={()=>{setScreen('welcome');setPhase(null);setGenScores([])}} className="px-8 py-3 rounded-full text-lg font-bold text-white shadow-lg hover:scale-105 transition-all" style={{background:'linear-gradient(135deg,#AD1457,#D81B60)',fontFamily:'Fredoka'}}>Play Again üîÑ</button>
        <div className="mt-4"><a href="index.html" className="text-sm font-semibold" style={{color:'#AD1457'}}>‚Üê Back to FrameShift</a></div>
      </div>
    </div></div>;
  }
  return null;
}

ReactDOM.render(<App/>,document.getElementById('root'));
</script>
</body>
</html>
