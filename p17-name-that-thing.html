<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Name That Thing ‚Äî FrameShift P17</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
<script>
  window.FrameShift={STORAGE_KEY:"frameshift_progress",load:function(){try{var r=localStorage.getItem(this.STORAGE_KEY);return r?JSON.parse(r):{sessions:{},achievements:[]}}catch(e){return{sessions:{},achievements:[]}}},save:function(d){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(d))}catch(e){}},saveSession:function(id,ts,tm,xs,xm,m){var d=this.load();if(!d.sessions[id])d.sessions[id]=[];d.sessions[id].push({date:new Date().toISOString(),train:{score:ts,max:tm},test:xs!==null?{score:xs,max:xm}:null,mastery:m});this.save(d)}};
</script>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:'Nunito',sans-serif;min-height:100vh;background:linear-gradient(135deg,#E0F7FA 0%,#B2EBF2 25%,#80DEEA 50%,#4DD0E1 75%,#26C6DA 100%);overflow-x:hidden}
  h1,h2,h3,.fredoka{font-family:'Fredoka',sans-serif}
  .frameshift-back{position:fixed;top:16px;left:16px;z-index:1000;background:rgba(255,255,255,0.85);backdrop-filter:blur(8px);padding:8px 16px;border-radius:20px;font-family:'Fredoka',sans-serif;font-weight:600;font-size:14px;color:#00695C;text-decoration:none;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:transform 0.2s}
  .frameshift-back:hover{transform:translateY(-1px)}
  @keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
  @keyframes popIn{0%{opacity:0;transform:scale(0.7)}70%{transform:scale(1.05)}100%{opacity:1;transform:scale(1)}}
  @keyframes glowPulse{0%,100%{box-shadow:0 0 20px rgba(38,198,218,0.3)}50%{box-shadow:0 0 40px rgba(38,198,218,0.6)}}
  .animate-slide-up{animation:slideUp 0.5s ease-out forwards}
  .animate-pop{animation:popIn 0.4s ease-out forwards}
  .animate-glow{animation:glowPulse 2s ease-in-out infinite}
</style>
</head>
<body>
<a href="index.html" class="frameshift-back">‚Üê FrameShift</a>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect}=React;

function playSound(t){try{const c=new(window.AudioContext||window.webkitAudioContext)();const n=c.currentTime;if(t==='correct'){[440,554,659].forEach((f,i)=>{const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=f;o.type='sine';g.gain.setValueAtTime(0.15,n+i*0.12);g.gain.exponentialRampToValueAtTime(0.001,n+i*0.12+0.3);o.start(n+i*0.12);o.stop(n+i*0.12+0.3)})}else if(t==='incorrect'){const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=330;o.type='sine';g.gain.setValueAtTime(0.12,n);o.frequency.linearRampToValueAtTime(220,n+0.3);g.gain.exponentialRampToValueAtTime(0.001,n+0.3);o.start(n);o.stop(n+0.35)}else if(t==='neutral'){const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=440;o.type='sine';g.gain.setValueAtTime(0.08,n);g.gain.exponentialRampToValueAtTime(0.001,n+0.25);o.start(n);o.stop(n+0.3)}else if(t==='complete'){[523,587,659,784,880].forEach((f,i)=>{const o=c.createOscillator();const g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=f;o.type='sine';g.gain.setValueAtTime(0.15,n+i*0.15);g.gain.exponentialRampToValueAtTime(0.001,n+i*0.15+0.4);o.start(n+i*0.15);o.stop(n+i*0.15+0.45)})}}catch(e){}}

function shuffle(a){const b=[...a];for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[b[i],b[j]]=[b[j],b[i]]}return b}

// Tier 1 (easier): straightforward descriptions with one twist
// Tier 2 (harder): figurative/indirect descriptions, analogies, riddles
const TRAIN_ITEMS = [
  // Tier 1 ‚Äî warm up
  { desc: "A kitchen tool shaped like a small bowl on a long handle, used for scooping soup.", answer: "ladle", emoji: "ü•Ñ", tier: 1,
    distractors: [{e:"üç¥",n:"fork"},{e:"üî™",n:"knife"}] },
  { desc: "The sharp point at the end of a pin ‚Äî so tiny you can barely see it.", answer: "pinhead", emoji: "üìå", tier: 1,
    distractors: [{e:"‚úèÔ∏è",n:"pencil tip"},{e:"ü™°",n:"needle eye"}] },
  { desc: "A natural opening in a rocky hillside ‚Äî dark inside, where bats might live.", answer: "cave", emoji: "üï≥Ô∏è", tier: 1,
    distractors: [{e:"üèîÔ∏è",n:"mountain"},{e:"üåä",n:"tide pool"}] },
  // Tier 2 ‚Äî figurative & indirect
  { desc: "A striped cat ‚Äî but much bigger, with claws that could take down a deer.", answer: "tiger", emoji: "üêÖ", tier: 2,
    distractors: [{e:"üêÜ",n:"leopard"},{e:"ü¶Å",n:"lion"}] },
  { desc: "An animal whose front teeth never stop growing, perfect for chewing through trees.", answer: "beaver", emoji: "ü¶´", tier: 2,
    distractors: [{e:"üêøÔ∏è",n:"squirrel"},{e:"ü¶î",n:"porcupine"}] },
  { desc: "Nature's skyscraper ‚Äî it starts as a seed but can grow taller than a ten-story building.", answer: "redwood tree", emoji: "üå≤", tier: 2,
    distractors: [{e:"üåµ",n:"cactus"},{e:"üåª",n:"sunflower"}] },
  { desc: "An underwater architect that builds entire cities from its own skeleton, one tiny polyp at a time.", answer: "coral", emoji: "ü™∏", tier: 2,
    distractors: [{e:"üêö",n:"seashell"},{e:"ü™®",n:"rock"}] },
  { desc: "A flying machine without an engine ‚Äî it rides invisible rivers of rising warm air.", answer: "glider", emoji: "üõ©Ô∏è", tier: 2,
    distractors: [{e:"ü™Å",n:"kite"},{e:"üéà",n:"balloon"}] },
];

const TEST_ITEMS = [
  { desc: "The Earth's blanket ‚Äî invisible but always pressing down on you with the weight of an ocean.", answer: "atmosphere", emoji: "üåç", tier: 2,
    distractors: [{e:"‚òÅÔ∏è",n:"cloud"},{e:"üåä",n:"ocean"}] },
  { desc: "A bird that can't fly but swims like a torpedo and wears a permanent tuxedo.", answer: "penguin", emoji: "üêß", tier: 2,
    distractors: [{e:"ü¶Ü",n:"duck"},{e:"ü¶Ö",n:"eagle"}] },
  { desc: "Tiny creatures that can carry fifty times their own weight and build complex underground kingdoms with millions of citizens.", answer: "ants", emoji: "üêú", tier: 2,
    distractors: [{e:"üêù",n:"bees"},{e:"ü™≤",n:"beetle"}] },
  { desc: "A plant's solar panel ‚Äî green, flat, and constantly turning light into food through chemistry.", answer: "leaf", emoji: "üçÉ", tier: 2,
    distractors: [{e:"üå∏",n:"flower"},{e:"üåø",n:"stem"}] },
  { desc: "An ancient reptile's modern cousin ‚Äî armored in scales, patient for hours, then lightning-fast jaws snap shut.", answer: "crocodile", emoji: "üêä", tier: 2,
    distractors: [{e:"ü¶é",n:"lizard"},{e:"üê¢",n:"turtle"}] },
  { desc: "The world's slowest clock ‚Äî dripping water builds a stone icicle hanging from a cave ceiling, one drop per century.", answer: "stalactite", emoji: "üèîÔ∏è", tier: 2,
    distractors: [{e:"‚ùÑÔ∏è",n:"icicle"},{e:"ü™®",n:"boulder"}] },
];

const ALL = [...TRAIN_ITEMS, ...TEST_ITEMS];
const TRAIN_TOTAL = TRAIN_ITEMS.length;
const TEST_TOTAL = TEST_ITEMS.length;
const MASTERY = 0.75;

function App() {
  const [screen, setScreen] = useState('welcome');
  const [phase, setPhase] = useState(null);
  const [idx, setIdx] = useState(0);
  const [trainScore, setTrainScore] = useState(0);
  const [testScore, setTestScore] = useState(0);
  const [options, setOptions] = useState([]);
  const [selected, setSelected] = useState(null);
  const [showFb, setShowFb] = useState(false);
  const [answered, setAnswered] = useState(false);

  const items = phase === 'train' ? TRAIN_ITEMS : TEST_ITEMS;
  const item = items[idx];

  useEffect(() => {
    if (!items[idx]) return;
    const it = items[idx];
    setOptions(shuffle([
      { emoji: it.emoji, name: it.answer, isCorrect: true },
      ...it.distractors.map(d => ({ emoji: d.e, name: d.n, isCorrect: false }))
    ]));
    setSelected(null); setShowFb(false); setAnswered(false);
  }, [idx, phase]);

  function start(p) {
    setPhase(p); setIdx(0);
    if (p === 'train') setTrainScore(0); else setTestScore(0);
    setSelected(null); setShowFb(false); setAnswered(false);
    setScreen('game');
  }

  function handleAnswer(i) {
    if (answered) return;
    setSelected(i); setAnswered(true);
    const correct = options[i].isCorrect;
    if (correct) { if (phase === 'train') setTrainScore(s=>s+1); else setTestScore(s=>s+1); }
    playSound(phase === 'train' ? (correct ? 'correct' : 'incorrect') : 'neutral');
    setShowFb(true);
  }

  function next() {
    if (idx < items.length - 1) { setIdx(idx + 1); }
    else {
      if (phase === 'train') setScreen('trainRes');
      else { if (window.FrameShift) window.FrameShift.saveSession("p17",trainScore,TRAIN_TOTAL,testScore,TEST_TOTAL,true); playSound('complete'); setScreen('testRes'); }
    }
  }

  const progress = ((idx + (answered ? 0.5 : 0)) / items.length) * 100;

  if (screen === 'welcome') return (
    <div className="min-h-screen flex items-center justify-center p-4"><div className="animate-slide-up max-w-lg w-full text-center">
      <div className="text-8xl mb-6">üîé</div>
      <h1 className="fredoka text-5xl font-bold mb-3" style={{color:'#00695C'}}>Name That Thing</h1>
      <p className="text-xl mb-2 font-semibold" style={{color:'#00796B'}}>FrameShift Program 17</p>
      <div className="bg-white bg-opacity-70 rounded-2xl p-6 mb-8 shadow-lg" style={{backdropFilter:'blur(8px)'}}>
        <p className="text-lg" style={{color:'#004D40'}}>Read the description carefully...</p>
        <p className="text-base mt-3" style={{color:'#00695C'}}>Then pick the picture that matches. Descriptions get tricky!</p>
      </div>
      <button onClick={()=>start('train')} className="px-10 py-4 rounded-full text-xl font-bold text-white shadow-lg hover:scale-105 active:scale-95 transition-all" style={{background:'linear-gradient(135deg,#00695C,#00897B)',fontFamily:'Fredoka'}}>Start Training üîé</button>
    </div></div>
  );

  if (screen === 'game') {
    const it = items[idx];
    const isTest = phase === 'test';
    const correctIdx = options.findIndex(o => o.isCorrect);

    return (
      <div className="min-h-screen flex flex-col items-center p-4 pt-16">
        <div className="w-full max-w-lg mb-4">
          <div className="flex justify-between items-center mb-2">
            <div className="flex items-center gap-2">
              <span className="fredoka font-bold text-sm px-3 py-1 rounded-full" style={{background:isTest?'#00695C':'#00897B',color:'white'}}>{isTest?'Test':'Training'}</span>
              {it.tier === 2 && <span className="fredoka text-xs font-bold px-2 py-0.5 rounded-full" style={{background:'#FFF8E1',color:'#F57F17'}}>‚òÖ Tricky</span>}
            </div>
            <span className="fredoka text-sm font-semibold" style={{color:'#00695C'}}>Clue {idx+1} of {items.length}</span>
          </div>
          <div className="w-full h-3 rounded-full overflow-hidden" style={{background:'rgba(255,255,255,0.5)'}}>
            <div className="h-full rounded-full transition-all duration-500" style={{width:`${progress}%`,background:'linear-gradient(90deg,#00695C,#26C6DA)'}}/>
          </div>
        </div>

        <div className="w-full max-w-lg animate-slide-up">
          <div className="bg-white bg-opacity-80 rounded-3xl p-6 shadow-xl" style={{backdropFilter:'blur(8px)'}}>
            {/* Description */}
            <div className="rounded-xl p-5 mb-5" style={{background:'linear-gradient(135deg,#E0F7FA,#B2EBF2)'}}>
              <p className="fredoka text-xs font-bold uppercase tracking-wider mb-2 text-center" style={{color:'#00897B'}}>Read the Clue</p>
              <p className="text-lg text-center leading-relaxed" style={{color:'#004D40',fontStyle:'italic'}}>"{it.desc}"</p>
            </div>

            <p className="fredoka text-lg font-bold text-center mb-4" style={{color:'#00695C'}}>What is it?</p>

            {/* Picture options */}
            <div className="grid grid-cols-3 gap-3 mb-4">
              {options.map((o, i) => {
                let bg='white',border='#B2EBF2',shadow='0 2px 6px rgba(0,0,0,0.08)';
                if(showFb&&!isTest){if(i===correctIdx){bg='#E8F5E9';border='#4CAF50';shadow='0 2px 12px rgba(76,175,80,0.3)'}else if(i===selected&&!o.isCorrect){bg='#FFEBEE';border='#EF5350'}}
                else if(showFb&&isTest&&i===selected){bg='#E0F7FA';border='#26C6DA'}
                return (
                  <button key={i} onClick={()=>handleAnswer(i)} disabled={answered}
                    className="p-4 rounded-2xl transition-all flex flex-col items-center"
                    style={{background:bg,border:`3px solid ${border}`,boxShadow:shadow,opacity:answered&&i!==selected&&!(showFb&&!isTest&&i===correctIdx)?0.4:1,cursor:answered?'default':'pointer'}}>
                    <span className="text-5xl mb-1">{o.emoji}</span>
                    <span className="text-xs font-semibold" style={{color:'#00695C'}}>{o.name}</span>
                  </button>
                );
              })}
            </div>

            {showFb && (
              <div className="animate-pop">
                {isTest ? (
                  <div className="text-center rounded-xl p-3 mb-4" style={{background:'#E0F7FA'}}>
                    <p className="fredoka font-semibold" style={{color:'#00695C'}}>Response recorded ‚úì</p>
                  </div>
                ) : (
                  <div className="text-center rounded-xl p-4 mb-4" style={{background:options[selected]?.isCorrect?'#E8F5E9':'#FFF3E0'}}>
                    {options[selected]?.isCorrect ?
                      <p className="fredoka font-semibold" style={{color:'#2E7D32'}}>‚úÖ You got it ‚Äî it's a <strong>{it.answer}</strong>!</p> :
                      <p className="fredoka font-semibold" style={{color:'#E65100'}}>It was: <strong>{it.answer}</strong> {it.emoji}</p>}
                  </div>
                )}
                <div className="text-center"><button onClick={next} className="px-8 py-3 rounded-full text-lg font-bold text-white shadow-lg hover:scale-105 active:scale-95 transition-all" style={{background:'linear-gradient(135deg,#00695C,#00897B)',fontFamily:'Fredoka'}}>Next ‚Üí</button></div>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  }

  if (screen === 'trainRes') {
    const pct = Math.round((trainScore/TRAIN_TOTAL)*100); const passed = pct >= MASTERY*100;
    return <div className="min-h-screen flex items-center justify-center p-4"><div className="animate-slide-up max-w-lg w-full text-center">
      <div className="bg-white bg-opacity-80 rounded-3xl p-8 shadow-xl" style={{backdropFilter:'blur(8px)'}}>
        <div className="text-6xl mb-4">{passed?'üéâ':'üîÑ'}</div>
        <h2 className="fredoka text-3xl font-bold mb-2" style={{color:'#00695C'}}>{passed?'Training Complete!':'Keep Studying!'}</h2>
        <div className="my-6 rounded-xl p-4" style={{background:'#E0F7FA'}}><p className="fredoka text-lg font-semibold" style={{color:'#00796B'}}>Score: {trainScore}/{TRAIN_TOTAL} ({pct}%)</p></div>
        {passed?<button onClick={()=>start('test')} className="px-10 py-4 rounded-full text-xl font-bold text-white shadow-lg hover:scale-105 transition-all" style={{background:'linear-gradient(135deg,#004D40,#00695C)',fontFamily:'Fredoka'}}>Start Test üß™</button>
        :<button onClick={()=>start('train')} className="px-10 py-4 rounded-full text-xl font-bold text-white shadow-lg hover:scale-105 transition-all" style={{background:'linear-gradient(135deg,#00695C,#00897B)',fontFamily:'Fredoka'}}>Try Again üîé</button>}
        <div className="mt-4"><a href="index.html" className="text-sm font-semibold" style={{color:'#00695C'}}>‚Üê Back to FrameShift</a></div>
      </div>
    </div></div>;
  }

  if (screen === 'testRes') {
    const pct = Math.round((testScore/TEST_TOTAL)*100);
    return <div className="min-h-screen flex items-center justify-center p-4"><div className="animate-slide-up max-w-lg w-full text-center">
      <div className="bg-white bg-opacity-80 rounded-3xl p-8 shadow-xl animate-glow" style={{backdropFilter:'blur(8px)'}}>
        <div className="text-6xl mb-4">üèÜ</div>
        <h2 className="fredoka text-3xl font-bold mb-2" style={{color:'#00695C'}}>Test Complete!</h2>
        <div className="my-6 rounded-xl p-4" style={{background:'#E0F7FA'}}><p className="fredoka text-xl font-bold" style={{color:'#004D40'}}>Score: {testScore}/{TEST_TOTAL} ({pct}%)</p></div>
        <button onClick={()=>{setScreen('welcome');setPhase(null)}} className="px-8 py-3 rounded-full text-lg font-bold text-white shadow-lg hover:scale-105 transition-all" style={{background:'linear-gradient(135deg,#00695C,#00897B)',fontFamily:'Fredoka'}}>Play Again üîÑ</button>
        <div className="mt-4"><a href="index.html" className="text-sm font-semibold" style={{color:'#00695C'}}>‚Üê Back to FrameShift</a></div>
      </div>
    </div></div>;
  }
  return null;
}

ReactDOM.render(<App/>,document.getElementById('root'));
</script>
</body>
</html>
